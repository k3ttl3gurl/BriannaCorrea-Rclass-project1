---
title: "Brianna Correa: Cleaning Script"
author: "Brianna Correa"
date: "2025-03-05"
output: html_document
---

# Setup

To begin with, let's load the necessary libraries required for our data processing and analysis. In this case, we're using `dplyr`, `tidyr`, and `skimr`.

```{r setup}
library(dplyr)
library(tidyr)
library(skimr)
Data Loading
We need to load the raw data before any cleaning can take place. The data is located in a specific directory, and we will read it into R using read.csv(). The file we're using here is a CSV file containing raw penguin data.

{r
Copy
Edit
setwd("../../Project-template/Data/Raw_data")

data_location <- "../../Data/Raw_data/penguins_raw_dirty.csv"
data_path <- "../../Data/Raw_data"

# Read the data
penguin_raw <- read.csv(data_location, check.names=FALSE)

# Check data dictionary
file_path <- file.path(data_path, "datadictionary.csv")
dictionary <- read.csv(file_path)
print(dictionary)
Visualizing the Raw Data
Before we clean the data, it's a good idea to visualize it to understand its structure and identify any outliers or issues that need attention.

{r
Copy
Edit
glimpse(penguin_raw)
summary(penguin_raw)
head(penguin_raw)
skim(penguin_raw)

# Histogram of raw data
hist(penguin_raw$`Body Mass (g)`, main="Histogram of Body Mass (g)", xlab="Body Mass (g)", col="orange", breaks=30)

# Bivariate plot
plot(penguin_raw$`Body Mass (g)`, penguin_raw$`Culmen Length (mm)`,
     main="Body Mass vs. Culmen Length", xlab="Body Mass (g)", ylab="Culmen Length (mm)", col="green", pch=20)
Cleaning the Data
We'll correct misspelled species names using grep().

{r
Copy
Edit
d1 <- penguin_raw

# Correct misspelled species names
d1$Species[grep("PengTin", d1$Species)] <- "Adelie Penguin (Pygoscelis adeliae)"
d1$Species[grep("Pengufn", d1$Species)] <- "Adelie Penguin (Pygoscelis adeliae)"
d1$Species[grep("PeOguin", d1$Species)] <- "Adelie Penguin (Pygoscelis adeliae)"
d1$Species[grep("AdeKie", d1$Species)] <- "Adelie Penguin (Pygoscelis adeliae)"
d1$Species[grep("AdelieMPenguin", d1$Species)] <- "Adelie Penguin (Pygoscelis adeliae)"
d1$Species[grep("Ventoo", d1$Species)] <- "Gentoo Penguin (Pygoscelis papua)"

# Normalize capitalization
d1$Species <- gsub(" penguin", " Penguin", d1$Species)

# Shorten species names
d1$Species <- gsub(" .*", "", d1$Species)

unique(d1$Species)
Handling Missing Data
We'll replace "missing" with NA in Culmen Length (mm) and convert the column to numeric.

{r
Copy
Edit
cl <- d1$`Culmen Length (mm)`
cl[cl == "missing"] <- NA
cl <- as.numeric(cl)
d1$`Culmen Length (mm)` <- cl

# Visualize cleaned column
skim(d1)
hist(d1$`Culmen Length (mm)`)
plot(d1$`Body Mass (g)`, d1$`Culmen Length (mm)`)
Handling Outliers
We fix values over 300 (likely incorrect measurements) and remove tiny body masses.

{r
Copy
Edit
d2 <- d1

# Adjust high values
cl <- d2$`Culmen Length (mm)`
cl[!is.na(cl) & cl > 300] <- cl[!is.na(cl) & cl > 300] / 10
d2$`Culmen Length (mm)` <- cl

# Visualize
skim(d2)
hist(d2$`Culmen Length (mm)`)
plot(d2$`Body Mass (g)`, d2$`Culmen Length (mm)`)

# Remove small body masses
d3 <- d2
mm <- d3$`Body Mass (g)`
d3 <- d3[mm >= 100, ]
Final Checks and Saving the Cleaned Data
We convert categorical variables to factors and save the cleaned data.

{r
Copy
Edit
# Convert to factors
d3$Species <- as.factor(d3$Species)
d3$Sex <- as.factor(d3$Sex)
d3$Island <- as.factor(d3$Island)

# Final data overview
skim(d3)

# Save data
saveRDS(d3, file = "../../Data/Processed_data/processeddata.rds")
write.csv(d3, file = "../../Data/Processed_data/processeddata.csv", row.names = FALSE)
Notes
Background of Palmer Penguin Data:

The Palmer Penguin Study collects data on three species of penguins (AdÃ©lie, Chinstrap, and Gentoo) in Antarctica to understand their physical traits and how they adapt to their environment.

Saving Data as RDS:

RDS retains R data types (factors, characters, etc.), while CSV is better for sharing but loses these formats.